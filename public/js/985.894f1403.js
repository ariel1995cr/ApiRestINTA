"use strict";(self["webpackChunkquasarfront"]=self["webpackChunkquasarfront"]||[]).push([[985],{3985:(a,e,l)=>{l.r(e),l.d(e,{default:()=>R});var t=l(3673),o=l(2323);const i=(0,t.HX)("data-v-f9cde42e");(0,t.dD)("data-v-f9cde42e");const n={class:"row col-6 mt-2 justify-start q-px-lg"},d={key:0,visible:!0,style:{height:"600px","max-width":"100%"}},s={key:1,class:"col-12 q-mt-sm"},r=(0,t.Wm)("div",{class:"text-h6"},"Editar coordenada",-1),c={class:"row justify-start q-mx-lg"},u={class:"col-12 text-h4 text-center"},p={class:"col-12 col-md-6",style:{height:"180px"}},m={class:"col-12 col-md-4"},g={class:"col-md-1 q-ml-sm"};(0,t.Cn)();const v=i(((a,e,l,v,b,h)=>{const f=(0,t.up)("q-btn-toggle"),y=(0,t.up)("q-icon"),w=(0,t.up)("q-input"),W=(0,t.up)("q-table"),q=(0,t.up)("statics-dashboard"),Z=(0,t.up)("q-card-section"),k=(0,t.up)("GMapMarker"),_=(0,t.up)("GMapMap"),x=(0,t.up)("q-btn"),H=(0,t.up)("q-card-actions"),Q=(0,t.up)("q-card"),E=(0,t.up)("q-dialog"),C=(0,t.up)("q-page"),P=(0,t.up)("q-img"),V=(0,t.up)("q-item-label"),z=(0,t.up)("q-item-section"),M=(0,t.up)("q-item"),j=(0,t.up)("q-list"),D=(0,t.up)("q-page-sticky"),I=(0,t.Q2)("close-popup"),S=(0,t.Q2)("ripple");return(0,t.wg)(),(0,t.j4)(t.HY,null,[(0,t.Wm)(C,{padding:"",style:{"padding-top":"300px"}},{default:i((()=>[(0,t.Wm)("div",n,[(0,t.Wm)(f,{modelValue:a.optionVisualizacion,"onUpdate:modelValue":e[1]||(e[1]=e=>a.optionVisualizacion=e),spread:"",class:"my-custom-toggle","no-caps":"",rounded:"",unelevated:"","toggle-color":"primary",color:"white","text-color":"primary",options:[{label:"Tabla",value:"tabla"},{label:"Graficos",value:"graficos"}]},null,8,["modelValue"])]),"tabla"==a.optionVisualizacion?((0,t.wg)(),(0,t.j4)("div",d,[(0,t.Wm)(W,{class:"mb-4 q-mt-sm",title:"Historico",rows:a.dataHistorico,columns:a.columns,"row-key":"id",pagination:{rowsPerPage:10},loading:a.loading,"binary-state-sort":""},{"top-right":i((()=>[(0,t.Wm)(w,{borderless:"",dense:"",debounce:"300",modelValue:a.filter,"onUpdate:modelValue":e[2]||(e[2]=e=>a.filter=e),placeholder:"Search"},{append:i((()=>[(0,t.Wm)(y,{name:"search"})])),_:1},8,["modelValue"])])),_:1},8,["rows","columns","loading"])])):((0,t.wg)(),(0,t.j4)("div",s,[(0,t.Wm)(q,{estacion:a.data.id},null,8,["estacion"])])),(0,t.Wm)(E,{modelValue:a.dialogEditar,"onUpdate:modelValue":e[3]||(e[3]=e=>a.dialogEditar=e)},{default:i((()=>[(0,t.Wm)(Q,{style:{width:"700px","max-width":"80vw"}},{default:i((()=>[(0,t.Wm)(Z,null,{default:i((()=>[r])),_:1}),(0,t.Wm)(Z,{class:"q-pt-none"},{default:i((()=>[(0,t.Wm)(_,{class:"bg-secondary p-2 border-2 rounded-2 col-12",center:{lat:a.marcador.lat,lng:a.marcador.lng},zoom:6,"map-type-id":"terrain",style:{height:"400px"}},{default:i((()=>[(0,t.Wm)(k,{key:a.marcador.id,position:a.marcador,draggable:!0,onDragend:a.cambiarPos},null,8,["position","onDragend"])])),_:1},8,["center"])])),_:1}),(0,t.Wm)(H,{align:"right",class:"bg-white text-teal"},{default:i((()=>[(0,t.wy)((0,t.Wm)(x,{flat:"",label:"Cerrar"},null,512),[[I]]),(0,t.Wm)(x,{flat:"",color:"primary",label:"Guardar",onClick:a.guardar},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(D,{class:"bg-white",expand:"",position:"top"},{default:i((()=>[(0,t.Wm)("div",c,[(0,t.Wm)("div",u,(0,o.zw)(a.data.denominacion),1),(0,t.Wm)("div",p,[(0,t.Wm)(P,{src:`/storage/estaciones/${a.data.id}.png`,ratio:16/9,style:{height:"180px"}},null,8,["src"])]),(0,t.Wm)("div",m,[(0,t.Wm)(j,{dense:"",bordered:"",padding:"",class:"rounded-borders scroll q-ml-sm",style:{height:"180px"}},{default:i((()=>[((0,t.wg)(!0),(0,t.j4)(t.HY,null,(0,t.Ko)(a.data.ultimaMedicion,((a,e)=>(0,t.wy)(((0,t.wg)(),(0,t.j4)(M,{clickable:"",key:e},{default:i((()=>[(0,t.Wm)(z,null,{default:i((()=>[(0,t.Wm)(V,null,{default:i((()=>[(0,t.Uk)((0,o.zw)(a.descripcion),1)])),_:2},1024),(0,t.Wm)(V,{caption:""},{default:i((()=>[(0,t.Uk)((0,o.zw)(a.valorMedicion)+" "+(0,o.zw)(a.unidad),1)])),_:2},1024)])),_:2},1024)])),_:2},1536)),[[S]]))),128))])),_:1})]),(0,t.Wm)("div",g,[(0,t.Wm)(x,{color:"secondary",label:"Editar",onClick:a.openDialog},null,8,["onClick"]),(0,t.Wm)(x,{class:"q-mt-sm",color:"primary",label:"Exportar datos",onClick:e[4]||(e[4]=e=>a.router.push({name:"exportar",params:{id:a.id}}))})])])])),_:1})],64)}));var b=l(1959),h=l(2584),f=l(5474),y=l(6249),w=l(6394),W=l(8825);const q=()=>{const a=(0,b.iH)([]),e=(0,b.iH)(null),l=(0,W.Z)(),t=(0,b.iH)([]),o=(0,b.iH)({sortBy:"updated_at",descending:!1,page:1,rowsPerPage:10,rowsNumber:10}),i=async(o,i)=>{y.Z.show({spinner:w.Z}),await f.api.get(`/api/v1/admin/estacion/${o}/historico/?props=${JSON.stringify(i)}&page=${i.pagination.page}`).then((e=>{t.value=[],t.value.push({name:"updated_at",field:"updated_at",label:"Fecha medicion",align:"left",sortable:!0}),e.data[0].mediciones.forEach(((a,e)=>{t.value.push({name:a.descripcion,field:a=>{var l,t;return null!==a&&void 0!==a&&null!==(l=a.mediciones[e])&&void 0!==l&&l.valorMedicion?null===a||void 0===a||null===(t=a.mediciones[e])||void 0===t?void 0:t.valorMedicion:"-"},label:a.descripcion,align:"left",sortable:!0})})),a.value=e.data})).catch((a=>{console.log(a),e.value=!0})),l.loading.hide()};return{data:a,error:e,columns:t,getHistoricoEstacion:i,pagination:o}};var Z=l(8709),k=l(9582);const _=(0,t.aZ)({name:"verEstacion",components:{StaticsDashboard:Z.Z},props:{id:{type:String,required:!0}},setup(a){const{data:e,getEstacion:l,updateEstacion:o}=(0,h.E)(),{data:i,columns:n,getHistoricoEstacion:d,pagination:s}=q(),r=(0,b.iH)(a.id),c=(0,k.tv)(),u=a=>{const{page:e,rowsPerPage:l,sortBy:t,descending:o}=a.pagination;s.value.page=e,s.value.rowsPerPage=l,s.value.sortBy=t,s.value.descending=o,d(r.value,a)};(0,t.bv)((async()=>{await l(a.id),await d(a.id,{pagination:s.value,filter:void 0})}));const p=(0,b.iH)(""),m=(0,b.iH)(!1),g=(0,b.iH)("tabla"),v=(0,b.iH)(!1),f=()=>{w.value.id=e.value.id,w.value.lat=Number(e.value.latitud),w.value.lng=Number(e.value.longitud),v.value=!0},y=async()=>{v.value=!1,l(e.value.id)},w=(0,b.iH)({id:null,lat:null,lng:null}),W=async a=>{w.value.lat=a.latLng.lat(),w.value.lng=a.latLng.lng()},Z=async()=>{const a=await o(w);a&&y()};return{props:a,data:e,getEstacion:l,dataHistorico:i,getHistoricoEstacion:d,onRequest:u,filter:p,loading:m,pagination:s,columns:n,dialogEditar:v,openDialog:f,marcador:w,cambiarPos:W,guardar:Z,optionVisualizacion:g,router:c}}});var x=l(4379),H=l(8761),Q=l(6429),E=l(4842),C=l(4554),P=l(6778),V=l(151),z=l(5589),M=l(9367),j=l(8240),D=l(1007),I=l(4027),S=l(7011),B=l(3414),U=l(2035),G=l(2350),L=l(677),N=l(6489),$=l(7518),T=l.n($);_.render=v,_.__scopeId="data-v-f9cde42e";const R=_;T()(_,"components",{QPage:x.Z,QBtnToggle:H.Z,QTable:Q.Z,QInput:E.Z,QIcon:C.Z,QDialog:P.Z,QCard:V.Z,QCardSection:z.Z,QCardActions:M.Z,QBtn:j.Z,QPageSticky:D.Z,QImg:I.Z,QList:S.Z,QItem:B.Z,QItemSection:U.Z,QItemLabel:G.Z}),T()(_,"directives",{ClosePopup:L.Z,Ripple:N.Z})}}]);