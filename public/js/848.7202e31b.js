"use strict";(self["webpackChunkquasarfront"]=self["webpackChunkquasarfront"]||[]).push([[848],{1848:(e,a,l)=>{l.r(a),l.d(a,{default:()=>x});var r=l(3673),o=l(2323);const t={class:"row justify-end q-mx-lg q-mt-lg"},i={class:"col-12"},n={class:"text-h6"};function s(e,a,l,s,u,d){const p=(0,r.up)("q-icon"),m=(0,r.up)("q-input"),c=(0,r.up)("q-btn"),v=(0,r.up)("q-td"),g=(0,r.up)("q-table"),w=(0,r.up)("q-card-section"),b=(0,r.up)("q-select"),f=(0,r.up)("q-card-actions"),y=(0,r.up)("q-card"),h=(0,r.up)("q-dialog"),k=(0,r.up)("q-page-sticky"),_=(0,r.up)("q-page"),q=(0,r.Q2)("close-popup");return(0,r.wg)(),(0,r.j4)(_,null,{default:(0,r.w5)((()=>[(0,r.Wm)("div",t,[(0,r.Wm)("div",i,[(0,r.Wm)(g,{title:"Usuarios",rows:e.data.data,columns:e.columns,"row-key":"id",pagination:e.pagination,loading:e.loading,filter:e.filter,onRequest:e.onRequest,"binary-state-sort":!0},{"top-right":(0,r.w5)((()=>[(0,r.Wm)(m,{borderless:"",dense:"",debounce:"300",modelValue:e.filter,"onUpdate:modelValue":a[1]||(a[1]=a=>e.filter=a),placeholder:"Search"},{append:(0,r.w5)((()=>[(0,r.Wm)(p,{name:"search"})])),_:1},8,["modelValue"])])),"body-cell-acciones":(0,r.w5)((a=>[(0,r.Wm)(v,{props:a},{default:(0,r.w5)((()=>[(0,r.Wm)("div",null,[(0,r.Wm)(c,{color:"primary",label:"Editar",onClick:l=>e.openDialog(a.row,!0)},null,8,["onClick"]),(0,r.Wm)(c,{class:"q-ml-lg",color:"red",label:"Eliminar",onClick:l=>e.eliminar(a.row)},null,8,["onClick"])])])),_:2},1032,["props"])])),_:1},8,["rows","columns","pagination","loading","filter","onRequest"])])]),(0,r.Wm)(h,{modelValue:e.medium,"onUpdate:modelValue":a[6]||(a[6]=a=>e.medium=a)},{default:(0,r.w5)((()=>[(0,r.Wm)(y,{style:{width:"700px","max-width":"80vw"}},{default:(0,r.w5)((()=>[(0,r.Wm)(w,null,{default:(0,r.w5)((()=>[(0,r.Wm)("div",n,(0,o.zw)(e.title),1)])),_:1}),(0,r.Wm)(w,{class:"q-pt-none"},{default:(0,r.w5)((()=>[(0,r.Wm)(m,{modelValue:e.userSelected.nombre,"onUpdate:modelValue":a[2]||(a[2]=a=>e.userSelected.nombre=a),label:"Nombre",error:e.errors.hasOwnProperty("nombre")},{error:(0,r.w5)((()=>{var a;return[(0,r.Uk)((0,o.zw)(null===(a=e.errors)||void 0===a?void 0:a.nombre[0]),1)]})),_:1},8,["modelValue","error"]),(0,r.Wm)(m,{modelValue:e.userSelected.apellido,"onUpdate:modelValue":a[3]||(a[3]=a=>e.userSelected.apellido=a),label:"Apellido",error:e.errors.hasOwnProperty("apellido")},{error:(0,r.w5)((()=>{var a;return[(0,r.Uk)((0,o.zw)(null===(a=e.errors)||void 0===a?void 0:a.apellido[0]),1)]})),_:1},8,["modelValue","error"]),(0,r.Wm)(m,{modelValue:e.userSelected.email,"onUpdate:modelValue":a[4]||(a[4]=a=>e.userSelected.email=a),label:"Email",error:e.errors.hasOwnProperty("email")},{error:(0,r.w5)((()=>{var a;return[(0,r.Uk)((0,o.zw)(null===(a=e.errors)||void 0===a?void 0:a.email[0]),1)]})),_:1},8,["modelValue","error"]),(0,r.Wm)(b,{modelValue:e.userSelected.rol,"onUpdate:modelValue":a[5]||(a[5]=a=>e.userSelected.rol=a),options:e.options,label:"Rol",error:e.errors.hasOwnProperty("rol")},{error:(0,r.w5)((()=>{var a;return[(0,r.Uk)((0,o.zw)(null===(a=e.errors)||void 0===a?void 0:a.rol[0]),1)]})),_:1},8,["modelValue","options","error"])])),_:1}),(0,r.Wm)(f,{align:"right",class:"bg-white text-teal"},{default:(0,r.w5)((()=>[(0,r.wy)((0,r.Wm)(c,{flat:"",label:"Cerrar"},null,512),[[q]]),e.editar?((0,r.wg)(),(0,r.j4)(c,{key:0,flat:"",color:"primary",label:"Guardar",onClick:e.actualizar},null,8,["onClick"])):((0,r.wg)(),(0,r.j4)(c,{key:1,flat:"",color:"primary",label:"Guardar",onClick:e.actualizar},null,8,["onClick"]))])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,r.Wm)(k,{position:"bottom-right",offset:[18,18]},{default:(0,r.w5)((()=>[(0,r.Wm)(c,{fab:"",icon:"add",color:"green",onClick:a[7]||(a[7]=a=>e.openDialog(null,!1))})])),_:1})])),_:1})}var u=l(1959),d=l(515),p=l.n(d),m=l(5474),c=l(6249),v=l(6394),g=l(8825);const w=()=>{const e=(0,g.Z)(),a=(0,u.iH)({}),l=(0,u.iH)(!1),r=(0,u.iH)([]),o=async a=>{c.Z.show({spinner:v.Z});const o=await m.api.post("/api/v1/admin/user",p()({},a)).then((a=>(l.value=!1,r.value=[],e.notify({message:a.data.msg,type:"positive"}),!0))).catch((a=>(a.value=!0,r.value=a.response.data.errors,e.notify({type:"negative",message:a.response.data.message}),!1)));return c.Z.hide(),o},t=async(l=null)=>{let o="";o=null==l?"/api/v1/admin/user/":"/api/v1/admin/user/"+JSON.stringify(l),await m.api.get(o).then((e=>{a.value.data=e.data.data,a.value.current_page=e.data.current_page,a.value.total=e.data.total,a.value.next_page=e.data.next_page_url,a.value.prev_page=e.data.prev_page_url,a.value.links=e.data.links})).catch((a=>{console.log(a),e.notify({color:"negative",position:"top",message:"Contactese con el administrador.",icon:"report_problem"}),r.value=a.response.data.errors}))},i=async(a,o)=>{c.Z.show({spinner:v.Z});const t=await m.api.put("/api/v1/admin/user/"+o,p()({},a)).then((a=>(l.value=!1,r.value=[],e.notify({message:a.data.msg,type:"positive"}),!0))).catch((a=>(a.value=!0,r.value=a.response.data.errors,e.notify({type:"negative",message:a.response.data.message}),!1)));return c.Z.hide(),t},n=async a=>{const o=await m.api.delete("/api/v1/admin/user/"+a).then((a=>(l.value=!1,r.value=[],e.notify({message:a.data.msg,type:"positive"}),!0))).catch((a=>(a.value=!0,r.value=a.response.data.errors,e.notify({type:"negative",message:a.response.data.message}),!1)));return o};return{createUsuario:o,data:a,errors:r,getUsuarios:t,updateUsuario:i,borrarUsuario:n}},b=(0,r.aZ)({name:"UsuariosIndex",setup(){const e=(0,g.Z)(),{errors:a,data:l,getUsuarios:o,updateUsuario:t,borrarUsuario:i,createUsuario:n}=w(),s=[{name:"nombre",label:"Nombre",field:"nombre",sortable:!0},{name:"apellido",label:"Apellido",field:"apellido",sortable:!0},{name:"email",label:"Email",field:"email",sortable:!0},{name:"rol",label:"Rol",field:"rol",sortable:!0},{name:"created_at",label:"Creado el",field:"created_at"},{name:"acciones",label:"Acciones"}],d=(0,u.iH)(!1),p=(0,u.iH)([]),m=(0,u.iH)(""),c=(0,u.iH)(!1),v=(0,u.iH)({sortBy:"id",descending:!1,page:1,rowsPerPage:10,rowsNumber:10});async function b(e){v.value=e.pagination,await o(e)}(0,r.bv)((async()=>{await o({pagination:v.value,filter:""})}));const f=(0,u.iH)({}),y=(0,u.iH)(""),h=(0,u.iH)(!1),k=["usuario","administrador"],_=(e,a)=>{h.value=a,h.value?(f.value=Object.assign({},e),y.value="Editar usuario"):(f.value={nombre:"",apellido:"",email:"",rol:""},y.value="Agregar usuario"),d.value=!0},q=async()=>{let e;e=h.value?await t(f.value,f.value.id):await n(f.value),e&&(f.value={},d.value=!1,await o({pagination:v.value,filter:""}))},W=a=>{e.dialog({title:"ConfirmaciÃ³n",message:"Desea eliminar el usuario?",cancel:!0,persistent:!0}).onOk((()=>{i(a.id),o({pagination:v.value,filter:""})})).onCancel((()=>{})).onDismiss((()=>{}))};return{actualizar:q,columns:s,data:l,errors:a,rows:p,filter:m,loading:c,pagination:v,medium:d,onRequest:b,openDialog:_,updateUsuario:t,userSelected:f,options:k,eliminar:W,title:y,editar:h}}});var f=l(4379),y=l(6429),h=l(4842),k=l(4554),_=l(3884),q=l(8240),W=l(6778),Z=l(151),U=l(5589),C=l(7637),V=l(9367),S=l(1007),Q=l(677),H=l(7518),P=l.n(H);b.render=s;const x=b;P()(b,"components",{QPage:f.Z,QTable:y.Z,QInput:h.Z,QIcon:k.Z,QTd:_.Z,QBtn:q.Z,QDialog:W.Z,QCard:Z.Z,QCardSection:U.Z,QSelect:C.Z,QCardActions:V.Z,QPageSticky:S.Z}),P()(b,"directives",{ClosePopup:Q.Z})}}]);