"use strict";(self["webpackChunkquasarfront"]=self["webpackChunkquasarfront"]||[]).push([[499],{3499:(a,e,t)=>{t.r(e),t.d(e,{default:()=>F});var l=t(3673),o=t(2323);const i=(0,l.HX)("data-v-6bda07ee");(0,l.dD)("data-v-6bda07ee");const n={class:"row justify-start q-mx-lg"},r={class:"col-12 text-h4 text-center"},s={class:"col-12 col-md-6",style:{height:"180px"}},d={class:"col-12 col-md-6"},c={class:"row justify-center q-mt-sm"},u={class:"row col-6 justify-start q-px-lg"},p={key:0,class:"col-12"},g={key:0},m={key:1},v={key:0},w={key:1,class:"col-12"},b=(0,l.Wm)("div",{class:"text-h6"},"Editar coordenada",-1);(0,l.Cn)();const h=i(((a,e,t,h,y,f)=>{const q=(0,l.up)("q-img"),W=(0,l.up)("q-item-label"),k=(0,l.up)("q-item-section"),Z=(0,l.up)("q-item"),_=(0,l.up)("q-list"),H=(0,l.up)("q-btn"),Q=(0,l.up)("q-btn-toggle"),x=(0,l.up)("q-icon"),j=(0,l.up)("q-input"),E=(0,l.up)("q-td"),C=(0,l.up)("q-tr"),V=(0,l.up)("q-table"),z=(0,l.up)("statics-dashboard"),P=(0,l.up)("q-scroll-area"),D=(0,l.up)("q-card-section"),I=(0,l.up)("GMapMarker"),M=(0,l.up)("GMapMap"),S=(0,l.up)("q-card-actions"),U=(0,l.up)("q-card"),B=(0,l.up)("q-dialog"),N=(0,l.Q2)("ripple"),R=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.j4)(l.HY,null,[(0,l.Wm)("div",n,[(0,l.Wm)("div",r,(0,o.zw)(a.data.denominacion),1),(0,l.Wm)("div",s,[(0,l.Wm)(q,{src:`/storage/estaciones/${a.data.id}.png`,ratio:16/9,style:{height:"180px"}},null,8,["src"])]),(0,l.Wm)("div",d,[(0,l.Wm)(_,{dense:"",bordered:"",padding:"",class:"rounded-borders scroll q-ml-sm",style:{height:"180px"}},{default:i((()=>[((0,l.wg)(!0),(0,l.j4)(l.HY,null,(0,l.Ko)(a.data.ultimaMedicion,((a,e)=>(0,l.wy)(((0,l.wg)(),(0,l.j4)(Z,{clickable:"",key:e},{default:i((()=>[(0,l.Wm)(k,null,{default:i((()=>[(0,l.Wm)(W,null,{default:i((()=>[(0,l.Uk)((0,o.zw)(a.descripcion),1)])),_:2},1024),(0,l.Wm)(W,{caption:""},{default:i((()=>[(0,l.Uk)((0,o.zw)(a.valorMedicion)+" "+(0,o.zw)(a.unidad),1)])),_:2},1024)])),_:2},1024)])),_:2},1536)),[[N]]))),128))])),_:1}),(0,l.Wm)("div",c,[(0,l.Wm)(H,{color:"secondary",label:"Editar",onClick:a.openDialog},null,8,["onClick"]),(0,l.Wm)(H,{class:"q-ml-sm",color:"primary",label:"Exportar datos",onClick:e[1]||(e[1]=e=>a.router.push({name:"exportar",params:{id:a.id}}))})])])]),(0,l.Wm)("div",u,[(0,l.Wm)(Q,{modelValue:a.optionVisualizacion,"onUpdate:modelValue":e[2]||(e[2]=e=>a.optionVisualizacion=e),spread:"",class:"my-custom-toggle","no-caps":"",rounded:"",unelevated:"","toggle-color":"primary",color:"white","text-color":"primary",options:[{label:"Tabla",value:"tabla"},{label:"Graficos",value:"graficos"}]},null,8,["modelValue"])]),(0,l.Wm)(P,{visible:!0,style:{height:"100vh","min-height":"inherit","max-height":"100vh","max-width":"100%"},class:"q-px-lg"},{default:i((()=>["tabla"==a.optionVisualizacion?((0,l.wg)(),(0,l.j4)("div",p,[(0,l.Wm)(V,{title:"Historico",rows:a.dataHistorico.data,columns:a.columns,"row-key":"id",pagination:a.pagination,"onUpdate:pagination":e[4]||(e[4]=e=>a.pagination=e),loading:a.loading,filter:a.filter,onRequest:a.onRequest,"binary-state-sort":""},{"top-right":i((()=>[(0,l.Wm)(j,{borderless:"",dense:"",debounce:"300",modelValue:a.filter,"onUpdate:modelValue":e[3]||(e[3]=e=>a.filter=e),placeholder:"Search"},{append:i((()=>[(0,l.Wm)(x,{name:"search"})])),_:1},8,["modelValue"])])),body:i((a=>[(0,l.Wm)(C,{props:a,class:"cursor-pointer"},{default:i((()=>[((0,l.wg)(!0),(0,l.j4)(l.HY,null,(0,l.Ko)(a.cols,(e=>((0,l.wg)(),(0,l.j4)(E,{key:e.name,props:a},{default:i((()=>["updated_at"==e.name?((0,l.wg)(),(0,l.j4)("p",g,(0,o.zw)(a.row[e.name]),1)):((0,l.wg)(),(0,l.j4)("div",m,[((0,l.wg)(!0),(0,l.j4)(l.HY,null,(0,l.Ko)(a.row.mediciones,((a,t)=>((0,l.wg)(),(0,l.j4)("p",{key:t},[e.name==a.descripcion?((0,l.wg)(),(0,l.j4)("span",v,(0,o.zw)(a.valorMedicion)+(0,o.zw)(a.unidad),1)):(0,l.kq)("",!0)])))),128))]))])),_:2},1032,["props"])))),128))])),_:2},1032,["props"])])),_:1},8,["rows","columns","pagination","loading","filter","onRequest"])])):((0,l.wg)(),(0,l.j4)("div",w,[(0,l.Wm)(z,{estacion:a.data.id},null,8,["estacion"])]))])),_:1}),(0,l.Wm)(B,{modelValue:a.dialogEditar,"onUpdate:modelValue":e[5]||(e[5]=e=>a.dialogEditar=e)},{default:i((()=>[(0,l.Wm)(U,{style:{width:"700px","max-width":"80vw"}},{default:i((()=>[(0,l.Wm)(D,null,{default:i((()=>[b])),_:1}),(0,l.Wm)(D,{class:"q-pt-none"},{default:i((()=>[(0,l.Wm)(M,{class:"bg-secondary p-2 border-2 rounded-2 col-12",center:{lat:a.marcador.lat,lng:a.marcador.lng},zoom:6,"map-type-id":"terrain",style:{height:"400px"}},{default:i((()=>[(0,l.Wm)(I,{key:a.marcador.id,position:a.marcador,draggable:!0,onDragend:a.cambiarPos},null,8,["position","onDragend"])])),_:1},8,["center"])])),_:1}),(0,l.Wm)(S,{align:"right",class:"bg-white text-teal"},{default:i((()=>[(0,l.wy)((0,l.Wm)(H,{flat:"",label:"Cerrar"},null,512),[[R]]),(0,l.Wm)(H,{flat:"",color:"primary",label:"Guardar",onClick:a.guardar},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}));var y=t(1959),f=t(2584),q=t(5474),W=t(6249),k=t(6394),Z=t(8825);const _=()=>{const a=(0,y.iH)([]),e=(0,y.iH)(null),t=(0,Z.Z)(),l=(0,y.iH)([]),o=(0,y.iH)({sortBy:"updated_at",descending:!1,page:1,rowsPerPage:10,rowsNumber:10}),i=async(i,n)=>{W.Z.show({spinner:k.Z}),await q.api.get(`/api/v1/admin/estacion/${i}/historico/?props=${JSON.stringify(n)}&page=${n.pagination.page}`).then((e=>{l.value=[],l.value.push({name:"updated_at",label:"Fecha medicion",align:"left",sortable:!0}),e.data.data[0].mediciones.forEach((a=>{l.value.push({name:a.descripcion,label:a.descripcion,align:"left",sortable:!0})})),a.value=e.data,o.value.rowsNumber=e.data.total,o.value.rowsPerPage=e.data.per_page,o.value.page=e.data.current_page})).catch((a=>{console.log(a),e.value=!0})),t.loading.hide()};return{data:a,error:e,columns:l,getHistoricoEstacion:i,pagination:o}};var H=t(823),Q=t(9582);const x=(0,l.aZ)({name:"verEstacion",components:{StaticsDashboard:H.Z},props:{id:{type:String,required:!0}},setup(a){const{data:e,getEstacion:t,updateEstacion:o}=(0,f.E)(),{data:i,columns:n,getHistoricoEstacion:r,pagination:s}=_(),d=(0,y.iH)(a.id),c=(0,Q.tv)(),u=a=>{const{page:e,rowsPerPage:t,sortBy:l,descending:o}=a.pagination;s.value.page=e,s.value.rowsPerPage=t,s.value.sortBy=l,s.value.descending=o,r(d.value,a)};(0,l.bv)((async()=>{await t(a.id),await r(a.id,{pagination:s.value,filter:void 0})}));const p=(0,y.iH)(""),g=(0,y.iH)(!1),m=(0,y.iH)("tabla"),v=(0,y.iH)(!1),w=()=>{h.value.id=e.value.id,h.value.lat=Number(e.value.latitud),h.value.lng=Number(e.value.longitud),v.value=!0},b=async()=>{v.value=!1,t(e.value.id)},h=(0,y.iH)({id:null,lat:null,lng:null}),q=async a=>{h.value.lat=a.latLng.lat(),h.value.lng=a.latLng.lng()},W=async()=>{const a=await o(h);a&&b()};return{props:a,data:e,getEstacion:t,dataHistorico:i,getHistoricoEstacion:r,onRequest:u,filter:p,loading:g,pagination:s,columns:n,dialogEditar:v,openDialog:w,marcador:h,cambiarPos:q,guardar:W,optionVisualizacion:m,router:c}}});var j=t(4027),E=t(7011),C=t(3414),V=t(2035),z=t(2350),P=t(8240),D=t(8761),I=t(7704),M=t(6429),S=t(4842),U=t(4554),B=t(8186),N=t(3884),R=t(6778),T=t(151),G=t(5589),L=t(9367),Y=t(6489),$=t(677),K=t(7518),A=t.n(K);x.render=h,x.__scopeId="data-v-6bda07ee";const F=x;A()(x,"components",{QImg:j.Z,QList:E.Z,QItem:C.Z,QItemSection:V.Z,QItemLabel:z.Z,QBtn:P.Z,QBtnToggle:D.Z,QScrollArea:I.Z,QTable:M.Z,QInput:S.Z,QIcon:U.Z,QTr:B.Z,QTd:N.Z,QDialog:R.Z,QCard:T.Z,QCardSection:G.Z,QCardActions:L.Z}),A()(x,"directives",{Ripple:Y.Z,ClosePopup:$.Z})}}]);