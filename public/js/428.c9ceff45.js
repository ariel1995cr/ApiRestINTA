"use strict";(self["webpackChunkquasarfront"]=self["webpackChunkquasarfront"]||[]).push([[428],{6428:(a,e,l)=>{l.r(e),l.d(e,{default:()=>T});var o=l(3673),t=l(2323);const i=(0,o.HX)("data-v-800ff19c");(0,o.dD)("data-v-800ff19c");const n={class:"row justify-start q-mx-lg"},r={class:"col-12 text-h4 text-center"},s={class:"col-12 col-md-6",style:{height:"180px"}},d={class:"col-12 col-md-6"},c={class:"row justify-center q-mt-sm"},u={class:"row col-6 justify-start q-px-lg"},p={key:0,class:"col-12"},m={key:1,class:"col-12"},g=(0,o.Wm)("div",{class:"text-h6"},"Editar coordenada",-1);(0,o.Cn)();const v=i(((a,e,l,v,h,b)=>{const f=(0,o.up)("q-img"),w=(0,o.up)("q-item-label"),y=(0,o.up)("q-item-section"),W=(0,o.up)("q-item"),q=(0,o.up)("q-list"),Z=(0,o.up)("q-btn"),H=(0,o.up)("q-btn-toggle"),_=(0,o.up)("q-icon"),k=(0,o.up)("q-input"),x=(0,o.up)("q-table"),Q=(0,o.up)("statics-dashboard"),E=(0,o.up)("q-scroll-area"),C=(0,o.up)("q-card-section"),V=(0,o.up)("GMapMarker"),P=(0,o.up)("GMapMap"),z=(0,o.up)("q-card-actions"),j=(0,o.up)("q-card"),M=(0,o.up)("q-dialog"),D=(0,o.Q2)("ripple"),I=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.j4)(o.HY,null,[(0,o.Wm)("div",n,[(0,o.Wm)("div",r,(0,t.zw)(a.data.denominacion),1),(0,o.Wm)("div",s,[(0,o.Wm)(f,{src:`/storage/estaciones/${a.data.id}.png`,ratio:16/9,style:{height:"180px"}},null,8,["src"])]),(0,o.Wm)("div",d,[(0,o.Wm)(q,{dense:"",bordered:"",padding:"",class:"rounded-borders scroll q-ml-sm",style:{height:"180px"}},{default:i((()=>[((0,o.wg)(!0),(0,o.j4)(o.HY,null,(0,o.Ko)(a.data.ultimaMedicion,((a,e)=>(0,o.wy)(((0,o.wg)(),(0,o.j4)(W,{clickable:"",key:e},{default:i((()=>[(0,o.Wm)(y,null,{default:i((()=>[(0,o.Wm)(w,null,{default:i((()=>[(0,o.Uk)((0,t.zw)(a.descripcion),1)])),_:2},1024),(0,o.Wm)(w,{caption:""},{default:i((()=>[(0,o.Uk)((0,t.zw)(a.valorMedicion)+" "+(0,t.zw)(a.unidad),1)])),_:2},1024)])),_:2},1024)])),_:2},1536)),[[D]]))),128))])),_:1}),(0,o.Wm)("div",c,[(0,o.Wm)(Z,{color:"secondary",label:"Editar",onClick:a.openDialog},null,8,["onClick"]),(0,o.Wm)(Z,{class:"q-ml-sm",color:"primary",label:"Exportar datos",onClick:e[1]||(e[1]=e=>a.router.push({name:"exportar",params:{id:a.id}}))})])])]),(0,o.Wm)("div",u,[(0,o.Wm)(H,{modelValue:a.optionVisualizacion,"onUpdate:modelValue":e[2]||(e[2]=e=>a.optionVisualizacion=e),spread:"",class:"my-custom-toggle","no-caps":"",rounded:"",unelevated:"","toggle-color":"primary",color:"white","text-color":"primary",options:[{label:"Tabla",value:"tabla"},{label:"Graficos",value:"graficos"}]},null,8,["modelValue"])]),(0,o.Wm)(E,{visible:!0,style:{height:"100vh","min-height":"inherit","max-height":"100vh","max-width":"100%"},class:"q-px-lg"},{default:i((()=>["tabla"==a.optionVisualizacion?((0,o.wg)(),(0,o.j4)("div",p,[(0,o.Wm)(x,{title:"Historico",rows:a.dataHistorico,columns:a.columns,"row-key":"id",pagination:{rowsPerPage:10},loading:a.loading,"binary-state-sort":""},{"top-right":i((()=>[(0,o.Wm)(k,{borderless:"",dense:"",debounce:"300",modelValue:a.filter,"onUpdate:modelValue":e[3]||(e[3]=e=>a.filter=e),placeholder:"Search"},{append:i((()=>[(0,o.Wm)(_,{name:"search"})])),_:1},8,["modelValue"])])),_:1},8,["rows","columns","loading"])])):((0,o.wg)(),(0,o.j4)("div",m,[(0,o.Wm)(Q,{estacion:a.data.id},null,8,["estacion"])]))])),_:1}),(0,o.Wm)(M,{modelValue:a.dialogEditar,"onUpdate:modelValue":e[4]||(e[4]=e=>a.dialogEditar=e)},{default:i((()=>[(0,o.Wm)(j,{style:{width:"700px","max-width":"80vw"}},{default:i((()=>[(0,o.Wm)(C,null,{default:i((()=>[g])),_:1}),(0,o.Wm)(C,{class:"q-pt-none"},{default:i((()=>[(0,o.Wm)(P,{class:"bg-secondary p-2 border-2 rounded-2 col-12",center:{lat:a.marcador.lat,lng:a.marcador.lng},zoom:6,"map-type-id":"terrain",style:{height:"400px"}},{default:i((()=>[(0,o.Wm)(V,{key:a.marcador.id,position:a.marcador,draggable:!0,onDragend:a.cambiarPos},null,8,["position","onDragend"])])),_:1},8,["center"])])),_:1}),(0,o.Wm)(z,{align:"right",class:"bg-white text-teal"},{default:i((()=>[(0,o.wy)((0,o.Wm)(Z,{flat:"",label:"Cerrar"},null,512),[[I]]),(0,o.Wm)(Z,{flat:"",color:"primary",label:"Guardar",onClick:a.guardar},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}));var h=l(1959),b=l(2584),f=l(5474),w=l(6249),y=l(6394),W=l(8825);const q=()=>{const a=(0,h.iH)([]),e=(0,h.iH)(null),l=(0,W.Z)(),o=(0,h.iH)([]),t=(0,h.iH)({sortBy:"updated_at",descending:!1,page:1,rowsPerPage:10,rowsNumber:10}),i=async(t,i)=>{w.Z.show({spinner:y.Z}),await f.api.get(`/api/v1/admin/estacion/${t}/historico/?props=${JSON.stringify(i)}&page=${i.pagination.page}`).then((e=>{o.value=[],o.value.push({name:"updated_at",field:"updated_at",label:"Fecha medicion",align:"left",sortable:!0}),e.data[0].mediciones.forEach(((a,e)=>{o.value.push({name:a.descripcion,field:a=>{var l,o;return null!==a&&void 0!==a&&null!==(l=a.mediciones[e])&&void 0!==l&&l.valorMedicion?null===a||void 0===a||null===(o=a.mediciones[e])||void 0===o?void 0:o.valorMedicion:"-"},label:a.descripcion,align:"left",sortable:!0})})),a.value=e.data})).catch((a=>{console.log(a),e.value=!0})),l.loading.hide()};return{data:a,error:e,columns:o,getHistoricoEstacion:i,pagination:t}};var Z=l(823),H=l(9582);const _=(0,o.aZ)({name:"verEstacion",components:{StaticsDashboard:Z.Z},props:{id:{type:String,required:!0}},setup(a){const{data:e,getEstacion:l,updateEstacion:t}=(0,b.E)(),{data:i,columns:n,getHistoricoEstacion:r,pagination:s}=q(),d=(0,h.iH)(a.id),c=(0,H.tv)(),u=a=>{const{page:e,rowsPerPage:l,sortBy:o,descending:t}=a.pagination;s.value.page=e,s.value.rowsPerPage=l,s.value.sortBy=o,s.value.descending=t,r(d.value,a)};(0,o.bv)((async()=>{await l(a.id),await r(a.id,{pagination:s.value,filter:void 0})}));const p=(0,h.iH)(""),m=(0,h.iH)(!1),g=(0,h.iH)("tabla"),v=(0,h.iH)(!1),f=()=>{y.value.id=e.value.id,y.value.lat=Number(e.value.latitud),y.value.lng=Number(e.value.longitud),v.value=!0},w=async()=>{v.value=!1,l(e.value.id)},y=(0,h.iH)({id:null,lat:null,lng:null}),W=async a=>{y.value.lat=a.latLng.lat(),y.value.lng=a.latLng.lng()},Z=async()=>{const a=await t(y);a&&w()};return{props:a,data:e,getEstacion:l,dataHistorico:i,getHistoricoEstacion:r,onRequest:u,filter:p,loading:m,pagination:s,columns:n,dialogEditar:v,openDialog:f,marcador:y,cambiarPos:W,guardar:Z,optionVisualizacion:g,router:c}}});var k=l(4027),x=l(7011),Q=l(3414),E=l(2035),C=l(2350),V=l(8240),P=l(8761),z=l(7704),j=l(6429),M=l(4842),D=l(4554),I=l(6778),S=l(151),B=l(5589),U=l(9367),G=l(6489),L=l(677),N=l(7518),$=l.n(N);_.render=v,_.__scopeId="data-v-800ff19c";const T=_;$()(_,"components",{QImg:k.Z,QList:x.Z,QItem:Q.Z,QItemSection:E.Z,QItemLabel:C.Z,QBtn:V.Z,QBtnToggle:P.Z,QScrollArea:z.Z,QTable:j.Z,QInput:M.Z,QIcon:D.Z,QDialog:I.Z,QCard:S.Z,QCardSection:B.Z,QCardActions:U.Z}),$()(_,"directives",{Ripple:G.Z,ClosePopup:L.Z})}}]);